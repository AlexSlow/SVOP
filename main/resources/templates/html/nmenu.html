<div th:fragment="menu">	
<style>
 .dropdown-menu .dropdown-menu {
	top: auto;
	left: 100%;
	transform: translateY(-2rem);
}

.dropdown-item.submenu::after {
	content: '▸';
	margin-left: 0.5rem;
}

.navbar-brand img{
width:150px;
}


.page-header {
  padding-bottom: 9px;
  margin: 40px 0 20px;
  border-bottom: 1px solid #eee;
}
#leng_change{
margin-left:0.1rem;
max-width:50em;
}

  </style>
  
 
 <nav class="navbar navbar-extend-md navbar-light bg-light stickly-top">
 <div  class="container-fluid">

 <div class="dropdown">
<button class="btn btn-secondary dropdown-toggle" type="button" data-toggle="dropdown" th:text="#{menu.navbutton}">Навигация
</button>
	<div class="dropdown-menu" id="0">
		<a class="dropdown-item" th:href="@{'/svop?lang='+${current_language}}" 			th:text="#{menu.main_page}">Главная страница</a>
		<a class="dropdown-item submenu"  href="#" 	th:text="#{menu.hendbook}" >Справочники</a>
		<div class="dropdown-menu" id="1">
			<a class="dropdown-item" th:href="@{'/svop/routs?lang='+${current_language}}" th:text="#{menu.routs}"  >Маршруты</a>
			<a class="dropdown-item" th:href="@{'/svop/airports?lang='+${current_language}}"  th:text="#{menu.airport}" >Аэрапорты</a>
			<a class="dropdown-item" th:href="@{'/svop/aircompanies?lang='+${current_language}}"  	th:text="#{menu.aircompany}" >Авиакомпании</a>
			<a class="dropdown-item" th:href="@{'/svop/nomer_reys?lang='+${current_language}}" 	th:text="#{menu.nomer_reys}" >Номера рейсов</a>
		</div>
	
		<a class="dropdown-item submenu" href="#" th:text="#{menu.sezon_ras}" >Сезонное расписание</a>
		<div class="dropdown-menu" id="1">
			<a class="dropdown-item" href="#"   th:text="#{menu.regular_reys}" >Регулярные рейсы</a>
			<a class="dropdown-item" href="#" 	th:text="#{menu.charter_reys}" >Чартерные рейсы</a>
			<a class="dropdown-item" href="#"   th:text="#{menu.forming_sezon}">Формирование</a>
		</div>
		<a class="dropdown-item submenu"  href="#" th:text="#{menu.daly_ras}" >Суточное расписание</a>
		<div class="dropdown-menu" id="1">
			<a class="dropdown-item" href="#" th:text="#{menu.dayly_forming}" >Формирование расписания</a>
			<a class="dropdown-item" href="#" th:text="#{menu.flight_plan}" >Графики полетов</a>
		</div>
		<a class="dropdown-item submenu" href="#" th:text="#{menu.tehn_plan}">Технологические графики</a>
		<div class="dropdown-menu" id="1">
			<a class="dropdown-item" href="#"  th:text="#{menu.temlate_forming}" >Формирование шаблонов</a>
			<a class="dropdown-item" href="#" th:text="#{menu.init}" >Инициализация</a>
		</div>
		
		<a class="dropdown-item submenu" href="#" th:text="#{menu.io}" >Система вывода</a>
		<div class="dropdown-menu" id="1">
			<a class="dropdown-item" href="#"  th:text="#{menu.tablo_sezon}">Табло сезонного расписания</a>
			<a class="dropdown-item" href="#"  th:text="#{menu.tablo_dayly}">Суточное расписание</a>
		</div>
		<a class="dropdown-item" href="#"  th:text="#{menu.document}">Документация</a>
		<a class="dropdown-item submenu" href="#"  th:text="#{menu.admin}">Администрирование</a>
		<div class="dropdown-menu" id="1">
		
				<a class="dropdown-item submenu" href="#"  th:text="#{menu.journal}">Журнал</a>
		<div class="dropdown-menu" id="2">
			<a class="dropdown-item" href="#"  th:text="#{menu.log}">Лог</a>
			<a class="dropdown-item" href="#"  th:text="#{menu.rout}">Маршруты</a>
			<a class="dropdown-item" href="#"  th:text="#{menu.airport}">Аэрапорты</a>
			<a class="dropdown-item" href="#"  th:text="#{menu.aircompany}">Авиакомпании</a>
			<a class="dropdown-item" href="#"   th:text="#{menu.nomer_reys}">Номера рейсов</a>
					<a class="dropdown-item" href="#"  th:text="#{menu.log_procedures}">Процедуры</a>
			<a class="dropdown-item" href="#"  th:text="#{menu.io}">Востановление системы</a>
		</div>
		
			<a class="dropdown-item" href="#"  th:text="#{menu.users}">Пользователи</a>
			<a class="dropdown-item" href="#"  th:text="#{menu.user_role}">Роли</a>
	
		</div>
	</div>
</div>

		<div class="page-header col-auto" >
  <h2 th:text="#{menu.title}">Портал аэропорта г.Барнаула имени Г.С Титова 
  </h2>
</div>


<a href="#" class="navbar-brand"><img src="/img/barnaul.jpg"/></a>

 
</div>
</nav>

<div class="header_second" style="margin-top:1rem; margin-bottom:1rem;">
<div  class="container-fluid">
 <div class="row h-75">
 <div class=" col-md-8 col-lg-8">
 </div>
 
 <div class="col-md-4 col-lg-4">
 <form role="form" method="post"  th:action="@{'/svop/logout?lang='+${current_language}}" class="form-inline">
 <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
 <div class="form-group" >

 <label for="user" class="control-label" th:text="#{menu.current_user}">Пользователь:</label>
      <span class="form-control-static  ml-2"><a href="#" th:text="${username}">имя_пользователя</a></span> 
	 </div>
	 
	  <div class="form-group ml-2 ">
	  <div id="flags"></div>
	 </div>
	 <div class="form-group ml-2 ">
	 <input type="submit"  name="exit"  th:value="#{buttons.exit}" class="btn btn-info ml-2  btn-sm ">
	</div>
 
 
 </form>
  </div>
 </div>
 </div>
 </div>

<script src="/js/jquery/jquery-3.3.1.min.js"></script>
  <script src="/js/jquery/select_plagin.js"></script>
  
<script>

// установим обработчики, элементу 
var level=0;

function clean()
{
$('.dropdown-menu').each(function(){
	let level_temp=$(this).attr("id");
	
	
	
	if (level<level_temp)
	{
	console.log(level_temp+" "+level+" "+$(this).text()); 
	$(this).hide(100);
	}
});
}

$('.dropdown-item').hover(
function(){
	level=$(this).parent(".dropdown-menu").attr("id");
	//console.log("попытка вызова"); 
	
	
	$('.dropdown-menu').each(function(){
	let level_temp=$(this).attr("id");
	if (level<level_temp)
	{
	//console.log(level_temp+" "+level+" "+$(this).text()); 
	$(this).hide(100);
	}
});
	
	
	
	
	//console.log("после вызова"); 
	$(this).next(".dropdown-menu").show(100);

}
	
,
function(){
	//$(this).next(".dropdown-menu").css("display", "none");
});

/*
$('.dropdown-menu').hover(   //Если мы покидаем меню
function(){
},
function(){
//alert(level);
	$('.submenu').each(function(){
$(this).next(".dropdown-menu").css("display", "none");
});
level=0;
}
);
*/
</script>





<script th:inline="javascript">
var token = $("meta[name='_csrf']").attr("content"); 
var header = $("meta[name='_csrf_header']").attr("content");
$.ajaxSetup({
        headers: {
            'X-Csrf-Token':token
        }
    });



//Работа с списком флагов 
var ddData = [
    {
        text: "",
        value: "ru",
        selected: [[${language.ru}]],
        description: "",
        imageSrc: "/img/flags/ru.png"
    },
    {
        text: "",
        value: "en",
        selected: [[${language.en}]],
        description: "",
        imageSrc: "/img/flags/en.png"
    },
    {
        text: "",
        value: "fr",
        selected: [[${language.fr}]],
        description: "",
        imageSrc: "/img/flags/fr.png"
    },
    {
        text: "",
        value: "de",
        selected: [[${language.de}]],
        description: "",
        imageSrc: "/img/flags/de.png"
    },
	 {
        text: "",
        value: "none",
        selected: [[${language.none}]],
        description: "",
        imageSrc: "/img/flags/none.png"
    }
];

$('#flags').ddslick({
    data:ddData,
    width:70,
	background :'white',
    selectText: "",
    imagePosition:"center",
    onSelected: function(selectedData){
	
	//alert(location.href);
     // console.log(JSON.stringify(selectedData.selectedData.value));
	 let lang=[[${current_language}]];
	 //console.log(lang+" "+selectedData.selectedData.value);
	 if (lang!=selectedData.selectedData.value)
	 {
	
	 //alert("start");
	 var url = window.location.href.split('?')[0];
	 // console.log(url);
	 $.post("http://localhost:5000/svop/api/language/select",{locale:selectedData.selectedData.value},function( data ) {
		window.location.replace(url+"?lang="+selectedData.selectedData.value);
});
	 
	 }
	 
	
    }   
});

</script>
</div>

  

